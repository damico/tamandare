#tables description


= How Tamandare uses DB =

Tamandare uses DB in two diferent layers:

 * Agent Layer
  * The agent layer uses Derby, and is configuration must follow these steps:
    # Download Derby from [http://db.apache.org/derby/releases/]
    # Uncompress it under /opt/derby
    # Set the Derby paths:
{{{
# export DERBY_HOME=/opt/derby/db-derby-10.6.1.0-bin
# export PATH=$PATH:$DERBY_HOME/bin
}}}
    # Enter into 'ij' environment (The file creatTables.sql can be found here [http://tamandare.googlecode.com/svn/trunk/tamandare/sql/createTables.sql])
{{{
# ij
ij version 10.6
ij> connect 'jdbc:derby:/home/YOURUSER/.tamandare/db;create=true';
ij> run '/tmp/createTables.sql';
ij> create table TAMANDARE.XMLDOCS (
DOC_ID INT GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1) 
NOT NULL PRIMARY KEY, 
DOC_DATA XML, 
DOC_URL_HASH VARCHAR(255),
DOC_TAGS_HASH VARCHAR(255),
DOC_TIMESTAMP TIMESTAMP NOT NULL DEFAULT CURRENT TIMESTAMP);
0 rows inserted/updated/deleted
ij> disconnect;
ij> quit;
}}}
 * Scheduler Layer 
   * The Scheduler layer uses DB2

= DB2 =

== Schema ==
{{{
CREATE SCHEMA TAMANDARE;
}}}
== Tables ==

 * DB2
{{{
create table TAMANDARE.XMLDOCS (
DOC_ID BIGINT     GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1, NO CACHE) PRIMARY KEY, 
DOC_DATA XML,
DOC_URL_HASH VARCHAR(255),
DOC_TAGS_HASH VARCHAR(255),
DOC_TIMESTAMP TIMESTAMP NOT NULL DEFAULT CURRENT TIMESTAMP);
}}}
 * DERBY
{{{
create table TAMANDARE.XMLDOCS (
DOC_ID INT GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1) NOT NULL PRIMARY KEY, 
DOC_DATA XML, 
DOC_URL_HASH VARCHAR(255),
DOC_TAGS_HASH VARCHAR(255),
DOC_TIMESTAMP TIMESTAMP NOT NULL DEFAULT CURRENT TIMESTAMP); 
}}}